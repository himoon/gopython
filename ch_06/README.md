# Chapter 06 쇼핑 트렌드 분석

## ⚠️ 코드 업데이트 안내
- **2025.08.18**: 네이버플러스 스토어 사이트에 직접 접근 시 오류가 발생하므로 코드를 변경해야 합니다.
  - 기존: `page.goto("https://shopping.naver.com/ns/home")`
  - 변경: 네이버 메인 → 네이버플러스 스토어 버튼 클릭 방식
  - `step_1_2.py`, `step_1_3.py` 파일의 소스 코드가 변경되었으니 확인해 주세요.

실습을 진행하기 위해 비주얼 스튜디오 코드 터미널에 아래 명령어를 입력하여 파이썬 패키지를 설치하세요.

```shell
pip install -U playwright python-docx
```

또한 아래 명령어를 입력하여 최신 크로미움 브라우저를 설치하세요.

```shell
playwright install
```

## ⚠️ 중요 변화 사항 - Playwright Inspector Target 설정

Playwright Inspector를 사용할 때 **중요한 설정 변경이 필요**합니다:

- **문제**: Inspector 실행 시 locator 음영처리가 안 되거나, 녹화된 코드가 JavaScript로 생성되는 문제
- **원인**: 현재 버전에서는 Python 환경임에도 Node.js가 기본값으로 설정되는 버그
- **해결법**: Inspector 창 우측 상단의 **'Target' 메뉴**를 클릭하여 Python > **'Pytest'** 또는 **'Library'** 선택

> 📋 **자세한 설정 방법은 [INSPECTOR_TARGET.md](../INSPECTOR_TARGET.md) 파일을 참고하세요!**

## 🚀 실습 순서
*   **[step_1_1.py](step_1_1.py)**: 실습 결과물을 저장할 `output` 폴더를 생성하여 기본 작업 환경을 설정합니다.
*   **[step_1_2_inspector.py](step_1_2_inspector.py)**: `Playwright`의 코드 생성기(Inspector)를 실행하는 방법을 보여주는 예제입니다. 네이버 스토어 페이지를 열고 `pause()`를 호출하여 코드 생성기를 활성화합니다.
*   **[step_1_2.py](step_1_2.py)**: `Playwright`를 실행하여 네이버 스토어 페이지로 이동하고, "하루 동안 보지 않기" 팝업을 자동으로 닫은 후, 사용자가 직접 웹페이지를 탐색할 수 있도록 `pause()`로 실행을 멈춥니다.
*   **[step_1_3.py](step_1_3.py)**: `step_1_2.py`의 함수를 재사용하여, 네이버 스토어 페이지에서 '베스트상품' 카테고리로 이동하는 자동화 단계를 추가합니다.
*   **[step_2_1.py](step_2_1.py)**: '베스트상품' 페이지에서 특정 카테고리(예: "패션의류")와 세부 옵션(예: "10대 여성")을 클릭하는 자동화 함수를 작성합니다.
*   **[step_2_2.py](step_2_2.py)**: 현재 페이지에 보이는 베스트 상품 목록의 스크린샷을 여러 개 찍어 `output` 폴더에 개별 이미지 파일로 저장하고, 파일 경로 목록을 JSON 파일로 저장합니다.
*   **[step_2_3.py](step_2_3.py)**: 이전 단계들에서 작성한 함수들을 조합하여, 특정 카테고리와 옵션을 받아 쇼핑 트렌드 정보를 수집(스크린샷 저장)하는 전체 자동화 흐름을 만듭니다.
*   **[step_3_1_docx.py](step_3_1_docx.py)**: `python-docx`를 사용하여 간단한 "Hello, World!" 텍스트에 폰트 크기와 굵기 속성을 적용하는 방법을 보여주는 기본 예제입니다.
*   **[step_3_1.py](step_3_1.py)**: `python-docx`를 사용하여 "쇼핑 트렌드 보고서"라는 제목과 현재 날짜가 포함된 기본적인 Word(.docx) 문서를 생성하고 저장합니다.
*   **[step_3_2_table.py](step_3_2_table.py)**: `python-docx`를 사용하여 3x2 크기의 간단한 표를 만들고 셀에 숫자를 채우는 방법을 보여주는 기본 예제입니다.
*   **[step_3_2.py](step_3_2.py)**: `step_2_3.py`으로 수집한 상품 이미지(스크린샷)들을 Word 문서 내의 표에 자동으로 삽입하여 보고서 내용을 채웁니다.
*   **[step_x.py](step_x.py)**: 전체 과정을 종합하여, 여러 카테고리와 옵션 조합에 대한 쇼핑 트렌드 보고서(.docx)를 각각 생성하는 최종 스크립트입니다.