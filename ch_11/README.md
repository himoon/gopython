# Chapter 11 아파트 매매 실거래가 지도

## 📋 실습 개요
이번 장에서는 **공공데이터 API와 지리정보 시각화**를 통해 아파트 매매 실거래가를 지도로 표현하는 프로젝트를 진행합니다.
- **공공데이터포털 API**를 활용한 실시간 아파트 거래 데이터 수집
- **통계지리정보(SGIS) API**를 사용한 행정구역 경계 데이터 처리
- **geopandas**를 통한 전문적인 지리공간 데이터 분석
- **matplotlib**로 단계 구분도(Choropleth map) 생성 및 시각화

## ⚙️ 패키지 설치
실습을 원활하게 진행하기 위해 비주얼 스튜디오 코드 터미널에서 아래 명령어를 실행하여 필요한 파이썬 패키지들을 설치해주세요.

```shell
pip install -U datakart geopandas matplotlib pandas seaborn streamlit tqdm
```

## 🔑 API 키 준비하기
지리정보 데이터 수집을 위해서는 **두 가지 API 키**가 필요합니다. 다음 단계를 따라 준비해주세요:

**1️⃣ 공공데이터포털 API 키**
1. [공공데이터포털](https://www.data.go.kr/) 접속
2. 회원가입 후 로그인
3. '아파트 매매 실거래가' 및 '법정동 코드' API 신청
4. 발급받은 API 키를 해당 실습 파일의 `DATAGO_KEY` 변수에 입력하세요
   - [step_2_1.py](step_2_1.py), [step_2_2.py](step_2_2.py), [step_2_3.py](step_2_3.py)

**2️⃣ 통계지리정보(SGIS) API 키**
1. [통계지리정보서비스](https://sgis.kostat.go.kr/developer/html/main.html) 접속
2. 회원가입 후 로그인
3. '인증키발급센터' - '인증키 신청' 메뉴에서 API 키 발급
4. 발급받은 서비스 ID와 보안 Key를 해당 실습 파일의 `SGIS_KEY`, `SGIS_SECRET` 변수에 입력하세요
   - [step_3_1.py](step_3_1.py), [step_3_2.py](step_3_2.py)

## 🚀 실습 단계별 가이드
*   **[step_1.py](step_1.py)**: 실습에 필요한 `input`, `output` 폴더를 생성하여 기본 작업 환경을 구성합니다.

*   **[step_2_1_lawd_code.py](step_2_1_lawd_code.py)**: `datakart`를 사용하여 법정동 코드 API를 호출하는 방법을 익히는 기본 예제입니다.

*   **[step_2_1.py](step_2_1.py)**: 공공데이터포털의 법정동 코드 API를 사용하여 특정 지역(예: "서울특별시")의 시군구 단위 법정동 코드와 주소명을 추출하고 CSV 파일로 체계적으로 저장합니다.

*   **[step_2_2.py](step_2_2.py)**: 공공데이터포털의 아파트 매매 실거래가 API를 사용하여 특정 지역 코드와 년월에 해당하는 아파트 거래 데이터를 조회하고, `pandas` DataFrame으로 변환하여 일부를 출력합니다.

*   **[step_2_3_tqdm.py](step_2_3_tqdm.py)**: `tqdm` 라이브러리를 사용하여 반복문의 진행 상황을 시각적인 프로그레스 바로 표시하는 방법을 학습하는 간단한 예제입니다.

*   **[step_2_3.py](step_2_3.py)**: `step_2_1.py`에서 얻은 지역 코드를 바탕으로, 2023년 1월부터 12월까지의 모든 아파트 매매 실거래가 데이터를 수집합니다. `tqdm`으로 진행 상황을 표시하고, 계약이 취소되지 않은 정상 거래 데이터만 필터링하여 CSV 파일로 저장합니다.

*   **[step_2_4.py](step_2_4.py)**: 수집된 아파트 실거래가 데이터를 바탕으로, 지역(시군구)별 단위 면적당 평균 거래 금액을 계산하고, 지역 주소명과 병합하여 최종 결과를 CSV 파일로 저장합니다.

*   **[step_3_1.py](step_3_1.py)**: 통계지리정보(SGIS) API를 사용하여 행정구역 경계 데이터를 GeoJSON 형식으로 조회하고, `geopandas`를 이용해 지오데이터프레임으로 변환한 후 간단하게 시각화하여 보여줍니다. (API 키 필요)

*   **[step_3_2.py](step_3_2.py)**: SGIS API를 호출하여 특정 행정구역 코드에 해당하는 경계 데이터를 GeoJSON 형식의 텍스트 파일로 저장하는 함수를 구현합니다.

*   **[step_3_3.py](step_3_3.py)**: `step_3_2.py`에서 저장한 행정구역 경계 데이터(GeoJSON)와 `step_2_4.py`에서 계산한 지역별 평균 거래가 데이터를 `geopandas`를 이용해 병합하고, 그 결과를 다시 GeoJSON 파일로 저장합니다.

*   **[step_3_4.py](step_3_4.py)**: 병합된 GeoJSON 데이터를 `geopandas`와 `matplotlib`을 사용하여 전문적인 단계 구분도(Choropleth map)로 시각화합니다. 각 지역을 평균 거래 금액에 따라 다른 색상으로 표시하고, 그 결과를 이미지 파일(.png)로 저장합니다.

*   **[step_x_hadm_codes.py](step_x_hadm_codes.py)**: SGIS API에서 제공하는 전체 행정구역 코드에서 시도 코드와 시도 명칭만 추출하여 특정 지역의 코드를 찾는 방법을 익히는 예제입니다.

*   **[step_x.py](step_x.py)**: 서울, 인천, 경기도의 아파트 실거래 데이터를 수집, 분석, 시각화하는 전체 과정을 하나로 합친 종합 스크립트입니다. 여러 지역의 데이터를 한 번에 처리하고, 최종 단계 구분도를 생성합니다.

모든 준비가 완료되었다면 아파트 매매 실거래가 지도 실습을 시작해보세요! 🚀