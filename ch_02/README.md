# Chapter 02 월별 카드 지출 내역 분석

## 📋 실습 개요
이번 장에서는 **데이터 분석과 시각화**를 통해 개인 카드 지출 패턴을 체계적으로 분석하는 시스템을 구현합니다.
- **pandas**를 활용한 Excel 파일 처리 및 데이터 통합
- **pivot_table**을 통한 월별/분류별 데이터 집계 분석
- **matplotlib & seaborn**을 사용한 다양한 차트 생성
- **데이터 그룹화**와 시각화를 통한 지출 패턴 인사이트 도출

## ⚙️ 패키지 설치
실습을 원활하게 진행하기 위해 비주얼 스튜디오 코드 터미널에서 아래 명령어를 실행하여 필요한 파이썬 패키지들을 설치해주세요.

```shell
pip install -U openpyxl pandas seaborn
```

## 🚀 실습 단계별 가이드
*   **[step_1.py](step_1.py)**: 실습에 필요한 `input`, `output` 폴더를 생성하여 기본 작업 환경을 구성합니다.

*   **[step_2_1.py](step_2_1.py)**: `pandas`를 사용하여 단일 엑셀 파일(`2024년1월.xlsx`)에서 특정 열과 행 범위를 지정하여 카드 지출 내역을 DataFrame으로 불러오는 기본적인 데이터 로딩 방법을 학습합니다.

*   **[step_2_2.py](step_2_2.py)**: `input` 폴더에 있는 여러 개의 월별 엑셀 파일을 한 번에 읽어, `pd.concat`으로 모든 데이터를 하나의 DataFrame으로 통합한 후, 새로운 엑셀 파일로 저장하는 데이터 통합 프로세스를 구현합니다.

*   **[step_3_1.py](step_3_1.py)**: 통합된 데이터를 바탕으로 `pivot_table`을 생성하여 지출을 월별, 분류별로 집계하고, 누적 금액을 계산한 뒤 정렬하여 새로운 엑셀 파일로 저장하는 과정을 단계별로 학습합니다.

*   **[step_3_2.py](step_3_2.py)**: `step_3_1.py`의 데이터 집계 및 정렬 로직을 하나의 스크립트로 정리하여, 월별/분류별 지출 내역과 누적 금액을 계산하고 엑셀 파일로 저장하는 자동화된 분석 프로세스를 완성합니다.

*   **[step_4_1.py](step_4_1.py)**: 집계된 데이터에서 상위 N개 지출 항목을 제외한 나머지를 '기타' 항목으로 그룹화하고, `matplotlib`을 사용하여 지출 비율을 보여주는 간단한 원그래프(pie chart)를 생성합니다.

*   **[step_4_2.py](step_4_2.py)**: `step_4_1.py`의 데이터 처리 로직을 `load_data` 함수로 모듈화하여 재사용성을 높이고, 동일한 원그래프 시각화를 구현합니다.

*   **[step_4_3.py](step_4_3.py)**: `seaborn`과 `matplotlib`을 사용하여 가독성을 높인 전문적인 원그래프를 제작합니다. 사용자 정의 함수로 각 항목의 실제 금액과 비율을 함께 표시하고, 범례와 제목을 추가하여 완성도 높은 차트를 구현합니다.

*   **[step_x.py](step_x.py)**: 원그래프 대신 `seaborn`의 막대그래프(bar chart)를 사용하여 분류별 누적 지출 금액을 시각화합니다. 테마, 그리드, 축 서식 등을 설정하여 데이터를 명확하게 비교하고 분석할 수 있는 시각화를 완성합니다.

모든 준비가 완료되었다면 카드 지출 내역 분석 실습을 시작해보세요! 🚀
